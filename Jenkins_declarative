pipeline
{
    agent {
    label ' Jenkins_Node1 '
    }
    tools {
        maven 'maven3.8.1'
    }
    
   
    options{
        buildDiscarder(logRotator(artifactDaysToKeepStr: '', artifactNumToKeepStr: '', daysToKeepStr: '3', numToKeepStr: '3'))
    }
  
    stages {
        stage ( 'CheckOutCode' )
        {
            steps{
                git credentialsId: '48308e77-f9fb-4fc1-bc62-284f1d02fcbc', url: 'https://github.com/ClassDev-Org/maven-web-application.git'
            }
        }
        
        stage ( 'Build ')
        {
            steps {
                sh " mvn clean package"
            }
        }
        stage ( ' ExecutingSonarQubeReport')
        {
            steps{
                sh " mvn sonar:sonar"
            }
        }
        stage ( ' UploadingArtiFactsIntoNexus')
        {
            steps{
                sh " mvn deploy"
            }
        }
        stage( ' DeployingArtiFactsIntoTomcat ')
        {
            steps{
                sh "cp target/maven-web-application.war /opt/apache-tomcat-9.0.50/webapps/ "
            }
        }
    }
        post{
            success {
                emailext body: '''Build Over - Flipkart-ScripyedWay
No issues we got.
Regards,
Jeevan''', subject: 'Build Over - Flipkart-ScripyedWay', to: 'djeevand140@gmail.com'

            }
            failure{
                emailext body: '''Build-Failure

Regards,
Monali''', subject: 'Build-Failure', to: 'monali123@gmail.com'
            }
        }
    }
